<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title> SignalR-enabled Linear System using LU decomposition Web Service </title>
    <!--By Neha Gadigi, Indpendent Study, UCONN Spring 2016 -->
</head>
<body>
    <!--User interface -->
    <p> SignalR-enabled Solving Linear System using LU decomposition Web Service </p>
    <p>Matrix #1 <input type="text" id="mat1" size="150" value="{&quot;matrixType&quot;:&quot;RowVector&quot;, &quot;data&quot;: [[1,2,1],[3,8,1],[0,4,1]], &quot;size&quot;: [3, 3]}" /> </p>
    <p>Matrix #2 <input type="text" id="mat2" size="150" value="{&quot;matrixType&quot;:&quot;ColumnVector&quot;, &quot;data&quot;: [[1,12,2]], &quot;size&quot;: [3, 1]}" /></p>
    <input type="button" id="send" value="Solve system of linear equations" />
    <p id="Product"></p>    
    
    <!----p id="Product1"></!--p-->
    

    <!--Script references -->
    <!--Reference the jQuery library. -->
    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <!--Reference the SignalR library. -->
    <script src="http://ajax.aspnetcdn.com/ajax/signalr/jquery.signalr-2.2.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="signalr/hubs"></script>
    <!--Add script to communicate with the server and update the page. -->
    <script type="text/javascript">
        $(function () {
            
            var ls = $.connection.LS;
            var i = 0;
            var data = [];
            var displayOutput = "[";
            // Start the connection.
            $.connection.hub.start().done(function () {

                $('#send').click(function () {
                    var mat1JSON = $('#mat1').val();
                    var mat2JSON = $('#mat2').val();
                    document.getElementById("Product").innerHTML = 'hi';
                    // Call the LU decomposition  method on the hub.
                    ls.server.ls1(mat1JSON, mat2JSON, $.connection.hub.id);
                });
       
            });
            // Create a function that the hub can call to display the product of two vectors.

            // Create a function that the hub can call to store the product of a row vector and matrix.
            ls.client.displayError1 = function () {
                document.getElementById("Product").innerHTML = 'hi';
                //document.getElementById("Product").innerHTML = 'Input Matrix should be a square matrix';   
            };

            // Create a function that the hub can call to store the product of a matrix and column vector.
            ls.client.store = function (product) {
                //Parse JSON using JSON.parse  http://www.w3schools.com/json/json_eval.asp
                document.getElementById("Product").innerHTML = 'hi';
                var productObj = JSON.parse(product);
                data[i] = productObj;
                i++;
            };
            //Create a function that hub can call to display the final output
            ls.client.displayOutput = function () {
                for (i = 0; i < data.length; i++) {
                    displayOutput += '[' + data[i] + ']';
                    if (i != data.length - 1) {
                        displayOutput += ','
                    } else displayOutput += ']'
                }
                document.getElementById("Product").innerHTML = 'The output is ' + displayOutput;
                displayOutput = "[";
                i = 0;
                data = [];
            };
            
            ls.client.displayError2 = function () {
                document.getElementById("Product").innerHTML = 'length of B Matrix is not equal to A matrix';                
            };
        });
    </script>

</body>

</html>
